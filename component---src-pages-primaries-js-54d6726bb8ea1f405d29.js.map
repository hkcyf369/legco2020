{"version":3,"sources":["webpack:///./src/pages/primaries.js","webpack:///./node_modules/gatsby/node_modules/core-js/modules/es6.array.find-index.js"],"names":["DirectHeader","styled","div","props","theme","spacing","DirectWrapper","breakpoints","up","palette","divider","warning","main","PrimaryPage","edges","data","allPrimary","allCandidates","t","useTranslation","useTheme","i18n","title","variant","dangerouslySetInnerHTML","__html","sort","a","b","node","order","map","edge","e","candiDemo","filter","p","constituency","key","camp","tags","findIndex","tag","name_zh","className","onClick","navigate","getLocalizedPath","color","seats","withLanguage","length","Number","target","PrimaryPageQuery","$export","$find","KEY","forced","Array","P","F","callbackfn","this","arguments","undefined"],"mappings":"iSASMA,EAAeC,IAAOC,IAAV,0EAAGD,CAAH,qBACN,SAAAE,GAAK,OAAIA,EAAMC,MAAMC,QAAQ,MAGnCC,EAAgBL,IAAOC,IAAV,2EAAGD,CAAH,8kBAGL,SAAAE,GAAK,OAAIA,EAAMC,MAAMC,QAAQ,MAEvC,SAAAF,GAAK,OAAIA,EAAMC,MAAMG,YAAYC,GAAG,SAKzB,SAAAL,GAAK,OAAIA,EAAMC,MAAMC,QAAQ,MACpC,SAAAF,GAAK,OAAIA,EAAMC,MAAMC,QAAQ,QAEP,SAAAF,GAAK,OAAIA,EAAMC,MAAMK,QAAQC,WAYvC,SAAAP,GAAK,OAAIA,EAAMC,MAAMC,QAAQ,OA6BlC,SAAAF,GAAK,OAAIA,EAAMC,MAAMK,QAAQE,QAAQC,QAwKrCC,UAnKK,SAAAV,GAAU,IAiECW,EAjEF,EAGvBX,EADFY,KAAQC,EAFiB,EAEjBA,WAAYC,EAFK,EAELA,cAOdC,EAAMC,cAAND,EACFd,EAAQgB,cAqDNC,EAASF,cAATE,KAoFR,OACE,oCACE,kBAAC,IAAD,CAAKC,MAAM,YACX,kBAACtB,EAAD,CAAcI,MAAOA,GACnB,kBAAC,IAAD,CACEmB,QAAQ,QACRC,wBAAyB,CACvBC,OAAQP,EAAE,oCAIhB,qCA7FyBJ,EA6FDE,EAAWF,MA3FnC,oCACE,kBAACR,EAAD,CAAeF,MAAOA,GACnBU,EACEY,MAAK,SAACC,EAAGC,GACR,OAAID,EAAEE,KAAKC,MAAQF,EAAEC,KAAKC,MAAc,EACpCH,EAAEE,KAAKC,MAAQF,EAAEC,KAAKC,OAAe,EAClC,KAERC,KAAI,SAAAC,GAAS,IACEC,EAAMD,EAAZH,KACFK,EAAYjB,EAAcH,MAAMqB,QACpC,SAAAC,GAAC,OACCA,EAAEP,KAAKQ,eAAiBJ,EAAEK,KACV,SAAhBF,EAAEP,KAAKU,MACPH,EAAEP,KAAKW,OAEJ,IADHJ,EAAEP,KAAKW,KAAKC,WAAU,SAAAC,GAAG,MAAoB,UAAhBA,EAAIC,cAIrC,OACE,yBACEL,IAAKL,EAAEK,IACPM,UAAU,iBACVC,QAAS,WACPC,mBAASC,YAAiB1B,EAAD,cAAqBY,EAAEK,QAGlD,yBAAKM,UAAU,SACb,kBAAC,IAAD,CAAYrB,QAAQ,UAAUyB,MAAM,iBACjC9B,EAAE,cAAe,CAAE+B,MAAOhB,EAAEgB,SAE/B,yBAAKL,UAAU,aACZM,YAAa7B,EAAMY,EAAG,kBAG3B,yBAAKW,UAAU,SACb,6BACE,kBAAC,IAAD,CAAYrB,QAAQ,MACjB2B,YAAa7B,EAAMY,EAAG,UAG3B,+BAUF,yBAAKW,UAAU,iBACb,+BAEF,yBAAKA,UAAU,WACb,yBAAKA,UAAU,UACb,yBAAKA,UAAU,qBACZV,EAAUiB,QAAU,KAEvB,kBAAC,IAAD,CAAY5B,QAAQ,QAAQyB,MAAM,iBAC/B9B,EAAE,WAGNkC,OAAOnB,EAAEoB,QAAU,GAClB,yBAAKT,UAAU,UACb,yBAAKA,UAAU,gBAAgBX,EAAEoB,QAAU,KAC3C,kBAAC,IAAD,CAAY9B,QAAQ,QAAQyB,MAAM,iBAC/B9B,EAAE,0BA+BtB,IAAMoC,EAAgB,c,kCC3O7B,IAAIC,EAAU,EAAQ,QAClBC,EAAQ,EAAQ,OAAR,CAA4B,GACpCC,EAAM,YACNC,GAAS,EAETD,IAAO,IAAIE,MAAM,GAAGF,IAAK,WAAcC,GAAS,KACpDH,EAAQA,EAAQK,EAAIL,EAAQM,EAAIH,EAAQ,QAAS,CAC/CjB,UAAW,SAAmBqB,GAC5B,OAAON,EAAMO,KAAMD,EAAYE,UAAUb,OAAS,EAAIa,UAAU,QAAKC,MAGzE,EAAQ,OAAR,CAAiCR","file":"component---src-pages-primaries-js-54d6726bb8ea1f405d29.js","sourcesContent":["import React from 'react';\nimport SEO from '@/components/seo';\nimport { graphql, navigate } from 'gatsby';\nimport { useTheme } from '@material-ui/core/styles';\nimport { Typography } from '@material-ui/core';\nimport styled from 'styled-components';\nimport { useTranslation } from 'react-i18next';\nimport { withLanguage, getLocalizedPath } from '@/utils/i18n';\n\nconst DirectHeader = styled.div`\n  margin: ${props => props.theme.spacing(2)}px 0;\n`;\n\nconst DirectWrapper = styled.div`\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  grid-gap: ${props => props.theme.spacing(1)}px;\n\n  ${props => props.theme.breakpoints.up('md')} {\n    grid-template-columns: repeat(4, 1fr);\n  }\n\n  .seat {\n    padding: ${props => props.theme.spacing(1)}px\n      ${props => props.theme.spacing(1.5)}px;\n    border-radius: 2px;\n    box-shadow: 0 1px 6px 0 ${props => props.theme.palette.divider};\n\n    .title {\n      display: flex;\n      justify-content: space-between;\n    }\n\n    .sub-title {\n      font-size: 0.65rem;\n    }\n\n    .roundup-title {\n      margin-top: ${props => props.theme.spacing(0.5)}px;\n      display: flex;\n      justify-content: space-between;\n    }\n\n    .roundup-title div {\n      line-height: 0.5;\n    }\n\n    .roundup-title div:last-child {\n      text-align: right;\n    }\n\n    .roundup {\n      display: flex;\n      justify-content: space-between;\n      align-items: baseline;\n    }\n\n    .center {\n      text-align: center;\n    }\n\n    .large-number {\n      font-size: 1.5rem;\n      font-weight: 900;\n    }\n\n    .demo {\n      color: ${props => props.theme.palette.warning.main};\n    }\n  }\n`;\n\nconst PrimaryPage = props => {\n  const {\n    data: { allPrimary, allCandidates },\n  } = props;\n  // const seats = [\n  //   ...Array.from(allGeoFuncDc2.nodes),\n  //   ...Array.from(allTradFunc.nodes),\n  // ];\n\n  const { t } = useTranslation();\n  const theme = useTheme();\n  // group data for chart\n  // const seatCount = {\n  //   UNRESOLVED: 70,\n  // };\n\n  // seats.forEach(seat => {\n  //   Object.keys(seat)\n  //     .filter(k => k.includes('expected'))\n  //     .map(key => {\n  //       const seatType = `${seat.type}_${key}`.toUpperCase();\n  //       if (typeof seatCount[seatType] === 'undefined') {\n  //         seatCount[seatType] = Number(seat[key]);\n  //       } else {\n  //         seatCount[seatType] += Number(seat[key]);\n  //       }\n  //       seatCount.UNRESOLVED -= Number(seat[key]);\n  //     });\n  // });\n\n  // Build chart data\n  // const chartData = Object.keys(seatColorMapping).map(scm => ({\n  //   key: scm,\n  //   label: t(`stackedBar.${scm}`),\n  //   value: seatCount[scm],\n  //   color: seatColorMapping[scm],\n  // }));\n\n  // // Build chart data\n  // const summary = {\n  //   DEMO: {\n  //     name: t('alias.DEMO'),\n  //     pos: 'start',\n  //     total: 0,\n  //     background: theme.palette.warning.light,\n  //   },\n  //   BEIJING: {\n  //     name: t('alias.BEIJING'),\n  //     pos: 'end',\n  //     total: 0,\n  //     background: theme.palette.info.light,\n  //   },\n  // };\n\n  // chartData.forEach(c => {\n  //   if (c.key.includes('DEMO')) {\n  //     summary.DEMO.total += c.value;\n  //   }\n  //   if (c.key.includes('BEIJING')) {\n  //     summary.BEIJING.total += c.value;\n  //   }\n  // });\n\n  const { i18n } = useTranslation();\n\n  const renderConstituencies = edges => {\n    return (\n      <>\n        <DirectWrapper theme={theme}>\n          {edges\n            .sort((a, b) => {\n              if (a.node.order > b.node.order) return 1;\n              if (a.node.order < b.node.order) return -1;\n              return 0;\n            })\n            .map(edge => {\n              const { node: e } = edge;\n              const candiDemo = allCandidates.edges.filter(\n                p =>\n                  p.node.constituency === e.key &&\n                  p.node.camp === 'DEMO' &&\n                  p.node.tags &&\n                  p.node.tags.findIndex(tag => tag.name_zh === '民主派初選') !==\n                    -1\n              );\n\n              return (\n                <div\n                  key={e.key}\n                  className=\"seat clickable\"\n                  onClick={() => {\n                    navigate(getLocalizedPath(i18n, `/primaries/${e.key}`));\n                  }}\n                >\n                  <div className=\"title\">\n                    <Typography variant=\"caption\" color=\"textSecondary\">\n                      {t('no_of_seats', { seats: e.seats })}\n                    </Typography>\n                    <div className=\"sub-title\">\n                      {withLanguage(i18n, e, 'primary_rule')}\n                    </div>\n                  </div>\n                  <div className=\"title\">\n                    <div>\n                      <Typography variant=\"h5\">\n                        {withLanguage(i18n, e, 'name')}\n                      </Typography>\n                    </div>\n                    <div>\n                      {/* <div style={{ width: '40px', height: '40px' }}>\n                        <SeatRowChart\n                          width={40}\n                          height={40}\n                          data={calculateSeatBox(e)}\n                        />\n                      </div> */}\n                    </div>\n                  </div>\n                  <div className=\"roundup-title\">\n                    <div />\n                  </div>\n                  <div className=\"roundup\">\n                    <div className=\"center\">\n                      <div className=\"large-number demo\">\n                        {candiDemo.length || '-'}\n                      </div>\n                      <Typography variant=\"body2\" color=\"textSecondary\">\n                        {t('lists')}\n                      </Typography>\n                    </div>\n                    {Number(e.target) > 0 && (\n                      <div className=\"center\">\n                        <div className=\"large-number\">{e.target || '-'}</div>\n                        <Typography variant=\"body2\" color=\"textSecondary\">\n                          {t('threshold')}\n                        </Typography>\n                      </div>\n                    )}\n                  </div>\n                </div>\n              );\n            })}\n        </DirectWrapper>\n      </>\n    );\n  };\n\n  return (\n    <>\n      <SEO title=\"Primary\" />\n      <DirectHeader theme={theme}>\n        <Typography\n          variant=\"body2\"\n          dangerouslySetInnerHTML={{\n            __html: t('primary_election_description'),\n          }}\n        />\n      </DirectHeader>\n      <>{renderConstituencies(allPrimary.edges)}</>\n    </>\n  );\n};\n\nexport default PrimaryPage;\n\nexport const PrimaryPageQuery = graphql`\n  query {\n    allPrimary {\n      edges {\n        node {\n          key\n          type\n          name_zh\n          name_en\n          alias_zh\n          alias_en\n          target\n          seats\n          expected_win_demo\n          primary_rule_zh\n          primary_rule_en\n          primary_description_zh\n          primary_description_en\n        }\n      }\n    }\n    allCandidates(filter: { enabled: { eq: \"Y\" } }) {\n      edges {\n        node {\n          uuid\n          camp\n          constituency\n          tags {\n            name_zh\n          }\n        }\n      }\n    }\n  }\n`;\n","'use strict';\n// 22.1.3.9 Array.prototype.findIndex(predicate, thisArg = undefined)\nvar $export = require('./_export');\nvar $find = require('./_array-methods')(6);\nvar KEY = 'findIndex';\nvar forced = true;\n// Shouldn't skip holes\nif (KEY in []) Array(1)[KEY](function () { forced = false; });\n$export($export.P + $export.F * forced, 'Array', {\n  findIndex: function findIndex(callbackfn /* , that = undefined */) {\n    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\nrequire('./_add-to-unscopables')(KEY);\n"],"sourceRoot":""}