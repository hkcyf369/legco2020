{"version":3,"sources":["webpack:///./src/pages/primary.js","webpack:///./node_modules/@material-ui/core/esm/useMediaQuery/useMediaQuery.js","webpack:///(webpack)/buildin/global.js","webpack:///./node_modules/gatsby/node_modules/core-js/modules/es6.array.find-index.js"],"names":["FullWidithWrapper","styled","div","theme","spacing","Container","DirectHeader","DirectWrapper","palette","divider","warning","main","info","success","PrimaryPage","props","data","allPrimary","allCandidates","t","useTranslation","isDesktop","useMediaQuery","breakpoints","up","i18n","renderConstituencies","edges","variant","dangerouslySetInnerHTML","__html","sort","a","b","node","order","map","edge","e","candiDemo","filter","p","constituency","key","camp","tags","findIndex","tag","name_zh","className","onClick","navigate","getLocalizedPath","color","seats","withLanguage","length","Number","target","title","container","PrimaryPageQuery","queryInput","options","arguments","undefined","name","query","replace","supportMatchMedia","window","matchMedia","_props$options","_props$options$defaul","defaultMatches","_props$options$matchM","_props$options$noSsr","noSsr","_props$options$ssrMat","ssrMatchMedia","_React$useState","matches","match","setMatch","active","queryList","updateMatch","addListener","removeListener","g","this","Function","module","exports","$export","$find","KEY","forced","Array","P","F","callbackfn"],"mappings":"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","file":"component---src-pages-primary-js-b304b3714f0d91c95929.js","sourcesContent":["import React from 'react';\nimport SEO from '@/components/seo';\nimport { graphql, navigate } from 'gatsby';\nimport theme from '@/themes';\nimport { Typography, useMediaQuery, Grid } from '@material-ui/core';\nimport styled from 'styled-components';\nimport { useTranslation } from 'react-i18next';\nimport { withLanguage, getLocalizedPath } from '@/utils/i18n';\n\nconst FullWidithWrapper = styled.div`\n  margin: 0 -${theme.spacing(2)}px;\n\n  .fullWidth-title {\n    font-weight: 700;\n    text-align: center;\n    padding: ${theme.spacing(1)}px 0;\n  }\n`;\n\nconst Container = styled.div`\n  margin: 0 ${theme.spacing(2)}px;\n`;\n\nconst DirectHeader = styled.div`\n  margin: ${theme.spacing(2)}px 0;\n`;\n\nconst DirectWrapper = styled.div`\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  grid-gap: ${theme.spacing(1)}px;\n\n  .seat {\n    padding: ${theme.spacing(1)}px ${theme.spacing(1.5)}px;\n    border-radius: 2px;\n    box-shadow: 0 1px 6px 0 ${theme.palette.divider};\n\n    .title {\n      display: flex;\n      justify-content: space-between;\n    }\n\n    .sub-title {\n      font-size: 0.65rem;\n    }\n\n    .roundup-title {\n      margin-top: ${theme.spacing(0.5)}px;\n      display: flex;\n      justify-content: space-between;\n    }\n\n    .roundup-title div {\n      line-height: 0.5;\n    }\n\n    .roundup-title div:last-child {\n      text-align: right;\n    }\n\n    .roundup {\n      display: flex;\n      justify-content: flex-start;\n      align-items: baseline;\n    }\n\n    .large-number {\n      font-size: 1.5rem;\n      font-weight: 900;\n    }\n\n    .demo {\n      text-align: left;\n      color: ${theme.palette.warning.main};\n    }\n\n    .beijing {\n      text-align: right;\n      color: ${theme.palette.info.main};\n    }\n\n    .other {\n      color: ${theme.palette.success.main};\n    }\n  }\n`;\n\nconst PrimaryPage = props => {\n  const {\n    data: { allPrimary, allCandidates },\n  } = props;\n  // const seats = [\n  //   ...Array.from(allGeoFuncDc2.nodes),\n  //   ...Array.from(allTradFunc.nodes),\n  // ];\n\n  const { t } = useTranslation();\n  const isDesktop = useMediaQuery(theme.breakpoints.up('md'));\n  // group data for chart\n  // const seatCount = {\n  //   UNRESOLVED: 70,\n  // };\n\n  // seats.forEach(seat => {\n  //   Object.keys(seat)\n  //     .filter(k => k.includes('expected'))\n  //     .map(key => {\n  //       const seatType = `${seat.type}_${key}`.toUpperCase();\n  //       if (typeof seatCount[seatType] === 'undefined') {\n  //         seatCount[seatType] = Number(seat[key]);\n  //       } else {\n  //         seatCount[seatType] += Number(seat[key]);\n  //       }\n  //       seatCount.UNRESOLVED -= Number(seat[key]);\n  //     });\n  // });\n\n  // Build chart data\n  // const chartData = Object.keys(seatColorMapping).map(scm => ({\n  //   key: scm,\n  //   label: t(`stackedBar.${scm}`),\n  //   value: seatCount[scm],\n  //   color: seatColorMapping[scm],\n  // }));\n\n  // // Build chart data\n  // const summary = {\n  //   DEMO: {\n  //     name: t('alias.DEMO'),\n  //     pos: 'start',\n  //     total: 0,\n  //     background: theme.palette.warning.light,\n  //   },\n  //   BEIJING: {\n  //     name: t('alias.BEIJING'),\n  //     pos: 'end',\n  //     total: 0,\n  //     background: theme.palette.info.light,\n  //   },\n  // };\n\n  // chartData.forEach(c => {\n  //   if (c.key.includes('DEMO')) {\n  //     summary.DEMO.total += c.value;\n  //   }\n  //   if (c.key.includes('BEIJING')) {\n  //     summary.BEIJING.total += c.value;\n  //   }\n  // });\n\n  const { i18n } = useTranslation();\n\n  const renderConstituencies = edges => {\n    return (\n      <>\n        <DirectHeader>\n          <Typography\n            variant=\"body2\"\n            dangerouslySetInnerHTML={{\n              __html: t('primary_election_description'),\n            }}\n          />\n        </DirectHeader>\n        <DirectWrapper>\n          {edges\n            .sort((a, b) => {\n              if (a.node.order > b.node.order) return 1;\n              if (a.node.order < b.node.order) return -1;\n              return 0;\n            })\n            .map(edge => {\n              const { node: e } = edge;\n              const candiDemo = allCandidates.edges.filter(\n                p =>\n                  p.node.constituency === e.key &&\n                  p.node.camp === 'DEMO' &&\n                  p.node.tags &&\n                  p.node.tags.findIndex(tag => tag.name_zh === '民主派初選') !==\n                    -1\n              );\n\n              return (\n                <div\n                  key={e.key}\n                  className=\"seat clickable\"\n                  onClick={() => {\n                    navigate(getLocalizedPath(i18n, `/primary/${e.key}`));\n                  }}\n                >\n                  <div className=\"title\">\n                    <Typography variant=\"caption\" color=\"textSecondary\">\n                      {t('no_of_seats', { seats: e.seats })}\n                    </Typography>\n                    <div className=\"sub-title\">\n                      {withLanguage(i18n, e, 'primary_rule')}\n                    </div>\n                  </div>\n                  <div className=\"title\">\n                    <div>\n                      <Typography variant=\"h5\">\n                        {withLanguage(i18n, e, 'name')}\n                      </Typography>\n                    </div>\n                    <div>\n                      {/* <div style={{ width: '40px', height: '40px' }}>\n                        <SeatRowChart\n                          width={40}\n                          height={40}\n                          data={calculateSeatBox(e)}\n                        />\n                      </div> */}\n                    </div>\n                  </div>\n                  <div className=\"roundup-title\">\n                    <div />\n                  </div>\n                  <div className=\"roundup\">\n                    <div className=\"large-number demo\">\n                      {candiDemo.length || '-'}\n                    </div>\n                    <Typography variant=\"body2\" color=\"textSecondary\">\n                      名單\n                    </Typography>\n                    {Number(e.target) > 0 && (\n                      <>\n                        <div className=\"large-number\">{e.target || '-'}</div>\n                        <Typography variant=\"body2\" color=\"textSecondary\">\n                          出線\n                        </Typography>\n                      </>\n                    )}\n                  </div>\n                </div>\n              );\n            })}\n        </DirectWrapper>\n      </>\n    );\n  };\n\n  return (\n    <>\n      <SEO title=\"Primary\" />\n      <FullWidithWrapper>\n        {/* <SingleStackedBarChart\n          data={chartData}\n          summary={summary}\n          title={t('simulation_result')}\n        />\n        <ExpandButton onClick={() => setShowSeatHistory(!showSeatHistory)}>\n          {showSeatHistory ? <ExpandLessIcon /> : <ExpandMoreIcon />}\n        </ExpandButton>\n        <Collapse in={showSeatHistory} timeout={100}>\n          {PastElectionResult.map(r => (\n            <SingleStackedBarChart\n              key={r.year}\n              data={r.result}\n              summary={r.summary}\n              title={r.year}\n            />\n          ))}\n        </Collapse> */}\n        {isDesktop ? (\n          <Grid container spacing={3}>\n            <Container>{renderConstituencies(allPrimary.edges)}</Container>\n          </Grid>\n        ) : (\n          <Container>{renderConstituencies(allPrimary.edges)}</Container>\n        )}\n      </FullWidithWrapper>\n    </>\n  );\n};\n\nexport default PrimaryPage;\n\nexport const PrimaryPageQuery = graphql`\n  query {\n    allPrimary {\n      edges {\n        node {\n          key\n          type\n          name_zh\n          name_en\n          alias_zh\n          alias_en\n          target\n          seats\n          expected_win_demo\n          primary_rule_zh\n          primary_rule_en\n          primary_description_zh\n          primary_description_en\n        }\n      }\n    }\n    allCandidates {\n      edges {\n        node {\n          enabled\n          uuid\n          camp\n          constituency\n          tags {\n            name_zh\n          }\n        }\n      }\n    }\n  }\n`;\n","import \"core-js/modules/es6.regexp.replace\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport * as React from 'react';\nimport { getThemeProps, useTheme } from '@material-ui/styles';\nexport default function useMediaQuery(queryInput) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var theme = useTheme();\n  var props = getThemeProps({\n    theme: theme,\n    name: 'MuiUseMediaQuery',\n    props: {}\n  });\n\n  if (process.env.NODE_ENV !== 'production') {\n    if (typeof queryInput === 'function' && theme === null) {\n      console.error(['Material-UI: The `query` argument provided is invalid.', 'You are providing a function without a theme in the context.', 'One of the parent elements needs to use a ThemeProvider.'].join('\\n'));\n    }\n  }\n\n  var query = typeof queryInput === 'function' ? queryInput(theme) : queryInput;\n  query = query.replace(/^@media( ?)/m, ''); // Wait for jsdom to support the match media feature.\n  // All the browsers Material-UI support have this built-in.\n  // This defensive check is here for simplicity.\n  // Most of the time, the match media logic isn't central to people tests.\n\n  var supportMatchMedia = typeof window !== 'undefined' && typeof window.matchMedia !== 'undefined';\n\n  var _props$options = _extends(_extends({}, props), options),\n      _props$options$defaul = _props$options.defaultMatches,\n      defaultMatches = _props$options$defaul === void 0 ? false : _props$options$defaul,\n      _props$options$matchM = _props$options.matchMedia,\n      matchMedia = _props$options$matchM === void 0 ? supportMatchMedia ? window.matchMedia : null : _props$options$matchM,\n      _props$options$noSsr = _props$options.noSsr,\n      noSsr = _props$options$noSsr === void 0 ? false : _props$options$noSsr,\n      _props$options$ssrMat = _props$options.ssrMatchMedia,\n      ssrMatchMedia = _props$options$ssrMat === void 0 ? null : _props$options$ssrMat;\n\n  var _React$useState = React.useState(function () {\n    if (noSsr && supportMatchMedia) {\n      return matchMedia(query).matches;\n    }\n\n    if (ssrMatchMedia) {\n      return ssrMatchMedia(query).matches;\n    } // Once the component is mounted, we rely on the\n    // event listeners to return the correct matches value.\n\n\n    return defaultMatches;\n  }),\n      match = _React$useState[0],\n      setMatch = _React$useState[1];\n\n  React.useEffect(function () {\n    var active = true;\n\n    if (!supportMatchMedia) {\n      return undefined;\n    }\n\n    var queryList = matchMedia(query);\n\n    var updateMatch = function updateMatch() {\n      // Workaround Safari wrong implementation of matchMedia\n      // TODO can we remove it?\n      // https://github.com/mui-org/material-ui/pull/17315#issuecomment-528286677\n      if (active) {\n        setMatch(queryList.matches);\n      }\n    };\n\n    updateMatch();\n    queryList.addListener(updateMatch);\n    return function () {\n      active = false;\n      queryList.removeListener(updateMatch);\n    };\n  }, [query, matchMedia, supportMatchMedia]);\n\n  if (process.env.NODE_ENV !== 'production') {\n    // eslint-disable-next-line react-hooks/rules-of-hooks\n    React.useDebugValue({\n      query: query,\n      match: match\n    });\n  }\n\n  return match;\n}","var g; // This works in non-strict mode\n\ng = function () {\n  return this;\n}();\n\ntry {\n  // This works if eval is allowed (see CSP)\n  g = g || new Function(\"return this\")();\n} catch (e) {\n  // This works if the window reference is available\n  if (typeof window === \"object\") g = window;\n} // g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\n\nmodule.exports = g;","'use strict';\n// 22.1.3.9 Array.prototype.findIndex(predicate, thisArg = undefined)\nvar $export = require('./_export');\nvar $find = require('./_array-methods')(6);\nvar KEY = 'findIndex';\nvar forced = true;\n// Shouldn't skip holes\nif (KEY in []) Array(1)[KEY](function () { forced = false; });\n$export($export.P + $export.F * forced, 'Array', {\n  findIndex: function findIndex(callbackfn /* , that = undefined */) {\n    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\nrequire('./_add-to-unscopables')(KEY);\n"],"sourceRoot":""}